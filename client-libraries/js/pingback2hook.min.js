(function(a){a.fn.mentions=function(b){function c(e,g){g=(((g||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var f=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,h=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(h,"").replace(f,function(k,j){return g.indexOf("<"+j.toLowerCase()+">")>-1?k:""})}var d={target_url:"",offset:0,limit:10};var b=a.extend(d,b);return this.each(function(){var e=a(this);if(b.host==""){e.html("Host URL (host) not passed to library.");return}if(b.example==""){e.html("Endpoint (endpoint) not passed to library.");return}if(b.target_url!=""){var f;f=b.host+"api/"+b.endpoint+"/latest.jsonp";a.ajax(f,{dataType:"jsonp",type:"GET",url:f,data:{target_url:b.target_url,offset:b.offset,limit:b.limit},jsonp:"callback",jsonpCallback:"jsonpCallback",success:function(n){var k="";var s;var r;var g;var l;var h;for(i=0;i<n.rows.length;i++){s=n.rows[i];r=s.value;g=r.details;l=new Date(r.unix_timestamp*1000);k+='<div id="'+s.id+'" class="p2h-item h-cite p-comment "';if(typeof g.handler!="undefined"){k+=g.handler}k+='">';if(typeof g.mf2!="undefined"){h=g.mf2;var m="";var p="";var j="";var o="";var q;for(ia=0;ia<h.items.length;ia++){q=h.items[ia];if(a.inArray("h-entry",q.type)){if(m==""){m=q.properties.author[0].properties.name[0]}if(p==""){p=q.properties.author[0].properties.url[0]}if(j==""){j=q.properties.author[0].properties.photo[0]}if(o==""){o=c(q.properties.content[0],"<p><br><a>")}}}k+='<div class="p2h-author-icon ">';k+='<address class="p-author author vcard h-card">';k+='<img src="'+j+'" class="u-photo" height="50" width="50" />';k+='<cite class="fn p-name"><a href="'+p+'" rel="external nofollow" class="u-url url">'+m+"</a></cite> ";k+='<span class="says">says:</span>        ';k+="</address>";k+="</div>";k+='<div class="p2h-comment-details">';k+='<p class="comment-meta">';k+='<a href="'+r.source_url+'" rel="nofollow bookmark" class="note-published u-url">';k+='<time class="dt-published published dt-updated updated" datetime="'+l.toISOString()+'">'+l.toLocaleString()+"</time>";k+="</a>";k+="</p>";k+='<p class="p-summary">'+o+"</p>";k+="</div>"}else{k+="<p>";k+='<a href="'+r.source_url+'" rel="nofollow bookmark" class="note-published u-url">'+g.title+'</a> mentioned <a class="u-url u-in-reply-to" href="'+r.target_url+'">this</a> on ';k+='<time class="dt-published published dt-updated updated" datetime="'+l.toISOString()+'">'+l.toLocaleString()+"</time>";k+="</p>"}k+="</div>"}e.html(k)},error:function(g,j,h){e.html(g.responseJSON.error_description)}})}else{e.html("Target URL (target_url) not passed to library.")}})}}(jQuery));